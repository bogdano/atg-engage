{% extends 'base.html' %}
{% load static %}
{% block title %}Leaderboard{% endblock %}

{% block content %}
        <h1 class="text-4xl md:text-5xl font-extrabold text-center mb-6 pt-12">
            {% if request.GET.leaderboard_id %}
                {% for leaderboard in leaderboards %}
                    {% if leaderboard.id|stringformat:"s" == request.GET.leaderboard_id %}
                        {{ leaderboard.leaderboard_name }} Leaderboard
                    {% endif %}
                {% endfor %}
            {% else %}
                All Activities Leaderboard
            {% endif %}
        </h1>

        <!-- Filtering Form -->
        <form hx-get="{% url 'leaderboard' %}" hx-push-url="true" hx-target=".htmx-body" hx-trigger="change" class="flex flex-col justify-center items-center gap-5 p-6 bg-teal-100 md:rounded-2xl md:max-w-4xl md:mx-auto">
            <div class="flex flex-row space-x-2">
                <!-- Leaderboard Type Filter -->
                <select name="leaderboard_id" class="rounded-2xl border border-teal-500 focus:border-teal-500 w-fit">
                    <option value="" {% if not request.GET.leaderboard_id %}selected{% endif %}>All Activities</option>
                    {% for leaderboard in leaderboards %}
                        <option value="{{ leaderboard.id }}" {% if request.GET.leaderboard_id == leaderboard.id|stringformat:"s" %}selected{% endif %}>
                            {{ leaderboard.leaderboard_name }}
                        </option>
                    {% endfor %}
                </select>
            
                <!-- Date Filter -->
                <select name="date_filter" class="rounded-2xl border border-teal-500 focus:border-teal-500 w-fit">
                    <option value="all_time" {% if request.GET.date_filter == "all_time" %}selected{% endif %}>All Time</option>
                    <option value="this_year" {% if request.GET.date_filter == "this_year" %}selected{% endif %}>This Year</option>
                    <option value="this_month" {% if request.GET.date_filter == "this_month" or not request.GET.date_filter %}selected{% endif %}>This Month</option>
                </select>
            </div>
            <!-- Toggle Buttons for Team and Individual Leaderboards -->
            <div class="mx-auto flex flex-row flex-nowrap space-x-0">
                <input type="radio" id="individual" name="leaderboard_mode" value="individual" {% if leaderboard_mode == "individual" %}checked{% endif %} class="hidden">
                <label for="individual" class="h-11 w-28 text-center cursor-pointer px-4 py-2.5 font-extrabold rounded-2xl rounded-r-none border border-teal-500 border-r-0 {% if leaderboard_mode == 'individual' %}bg-teal-400 text-white{% else %}text-stone-700 bg-white{% endif %}">Individual</label>
                <input type="radio" id="team" name="leaderboard_mode" value="team" {% if leaderboard_mode == "team" %}checked{% endif %} class="hidden">
                <label for="team" class="h-11 w-28 text-center cursor-pointer px-4 py-2.5 font-extrabold rounded-2xl rounded-l-none border border-teal-500 border-l-0 {% if leaderboard_mode == 'team' %}bg-teal-400 text-white{% else %}text-stone-700 bg-white{% endif %}">Team</label>
            </div>

        </form>

        <!-- Leaderboard Content -->
        <div id="leaderboard" class="mt-6">
            <!-- This will be filled dynamically with HTMX or initial content if needed -->
            {% if leaderboard_mode == "team" %}
                {% include 'partials/team_leaderboard.html' %}
            {% else %}
                {% include 'partials/individual_leaderboard.html' %}
            {% endif %}
        </div>
{% endblock %}